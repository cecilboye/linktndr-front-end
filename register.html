<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Join LinkTindr</title>
    <!-- Bootstrap CSS -->
    <link rel="stylesheet" href="./bootstrap/css/bootstrap.min.css"/>
    <link rel="stylesheet" href="./bootstrap/css/bootstrap.rtl.min.css"/>
    <link rel="stylesheet" href="./bootstrap/css/bootstrap-grid.min.css"/>
    <link rel="stylesheet" href="./includes/globalstyle.css"/>
    <!-- jQuery library -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>
    <!-- Bootstrap JS -->
    <script src="./bootstrap/js/bootstrap.min.js"></script>
    <script src="./includes/globalscript.js"></script>
</head>
<body>
    <div id="header"></div>
    <div class="container">
        <div class="row">
            <div class="col-sm-12 text-center">
                <br>
                <h1>Welcome to LinkTindr</h1>
            </div>
        </div>
        <div class="row">
            <div class="col-sm-4 col-sm"></div>
            <div class="col-sm-4 col-sm">
                <form>
                    <div class="form-group">
                        <label for="email">Emailadres:</label>
                        <input type="email" class="form-control" id="Email" placeholder="email@email.nl"/>
                    </div>
                    <div class="form-group">
                        <label for="pwd">Wachtwoord:</label>
                        <input type="password" class="form-control" id="Password" placeholder="p@ssw0rd!"/>
                        <label for="pwd">Wachtwoord nogmaals:</label>
                        <input type="password" class="form-control" id="Password2" placeholder="p@ssw0rd!"/>
                    </div>
                    <div class="form-group">
                        <label for="usertype">Type gebruiker:</label>
                        <select class="form-control"  id="UserType" onchange="showDiv(this)">
                            <option value="" disabled selected>Selecteer wat je bent:</option>
                            <option value="Medewerker">Medewerker</option>
                            <option value="Talentmanager">Talentmanager</option>
                            <option value="Opdrachtgever">Opdrachtgever</option>
                          </select>
                    </div>
                    <div class="form-group hiddeninput Medewerker Talentmanager">
                        <label for="firstname">Voornaam:</label>
                        <input type="text" class="form-control" id="FirstName" placeholder="Edo"/>
                    </div>
                    <div class="form-group hiddeninput Medewerker Talentmanager">
                        <label for="lastname">Achternaam:</label>
                        <input type="text" class="form-control" id="LastName" placeholder="Rooseboom"/>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="DateOfBirth">Geboortedatum:</label>
                        <input type="date" class="form-control" id="DateOfBirth" placeholder="27-11-1997"/>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="PostCode">Postcode:</label>
                        <input type="text" class="form-control" id="PostCode" placeholder="6969HH"/>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="HouseNumber">Huisnummer:</label>
                        <input type="text" class="form-control" id="HouseNumber" placeholder="69a"/>
                    </div>
                    <div class="form-group hiddeninput Opdrachtgever">
                        <label for="name">Bedrijfsnaam:</label>
                        <input type="text" class="form-control" id="Name" placeholder="Bert B.V."/>
                    </div>
                    <div class="form-group hiddeninput Medewerker Talentmanager Opdrachtgever">
                        <label for="telephone">Telefoonnummer:</label>
                        <input type="number" class="form-control" id="Telephone" placeholder="0669696969"/>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="Talentmanager">Talentmanager:</label>
                        <select class="form-control"  id="Talentmanager">
                        </select>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="radius">Afstand voorkeur: <span id="rangevalue">50</span>km</label>
                        <input type="range" class="form-control" id="Radius" min="10" max="200" value="50" oninput="showValue(this.value)" />
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="uitstroomrichting">uitstroomrichting:</label>
                        <select class="form-control"  id="Specialization">
                            <option value="" disabled selected>Selecteer je uitstroomrichting:</option>
                          </select>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <textarea class="form-control" name="bio" id="Bio" cols="30" rows="10" placeholder="Vul hier een korte beschrijving van jezelf in"></textarea>
                    </div>
                    <div class="form-group hiddeninput Medewerker">
                        <label for="image">Foto:</label>
                        <input  type="text" class="form-control" id="Image" placeholder="Vul hier een URL van een foto die je wilt uploaden"/>
                    </div>
                    <div class="form-group hiddeninput Medewerker Talentmanager Opdrachtgever">
                        <button type="submit" class="btn btn-primary" onclick="submitForm(event)">Registreer</button>
                        <label for="submit"><span id="submitinfo" class="text-success"></span></label>
                    </div>
                    <br>
                    <br>
                    <br>
                    <br>
                </form>
            </div>
        </div>
    </div>
    <div id="footer"></div>
    <script>
		function submitForm(e) {
            e.preventDefault();
			// Get form data
			const email = document.getElementById("Email").value;
			const password = document.getElementById("Password").value;
            const password2 = document.getElementById("Password2").value;
            const usertype = document.getElementById("UserType").value;
            const firstname = document.getElementById("FirstName").value;
            const lastname = document.getElementById("LastName").value;
            const telephone = document.getElementById("Telephone").value;
            const dateofbirth = document.getElementById("DateOfBirth").value;
            const postcode = document.getElementById("PostCode").value;
            const housenumber = document.getElementById("HouseNumber").value;
            const name = document.getElementById("Name").value;
            const radius = document.getElementById("Radius").value;
            const specialization = document.getElementById("Specialization").value;
            const bio = document.getElementById("Bio").value;
            const image = document.getElementById("Image").value;
            const talentmanagerid = document.getElementById("Talentmanager").value;

            let data = {};
            switch(usertype){
                case "Medewerker":
                    data = {
                        name: firstname+" "+lastname,
                        dateofbirth: dateofbirth,
                        postcode: postcode,
                        housenumber: housenumber,
                        email: email,
                        password: password,
                        telephone: telephone,
                        radius: radius,
                        uitstroomrichting: specialization,
                        photo: image,
                        profiletext: bio,
                        talentmanagerid: talentmanagerid
                    }
                break;
                case "Talentmanager":
                    data = {
                        email: email,
                        password: password,
                        name: firstname+" "+lastname,
                        telephone: telephone,
                    }
                break;
                case "Opdrachtgever":
                    data = {
                        email: email,
                        password: password,
                        name: name,
                        telephone: telephone,
                    }
                break;
            }
			// Send data as JSON to backend URL using Fetch API
			fetch(URL + usertype + '/add', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify(data)
            })
            .then(response => {
                if (!response.ok) {
                    throw new Error('Network response was not ok');
                }
                return response.json();
            })
            .then(data => {
                if(data){
                    document.getElementById("submitinfo").innerHTML = 'registratie succesvol afgerond. <a href="./index.html">klik hier</a> om naar de inlog pagina te gaan.';
                }
            })
            .catch(error => console.error(error));
		}
        //show inputs based on selected option
        function showDiv(e){
            let elements = document.getElementsByClassName("hiddeninput");
            Array.from(elements).forEach(function (element) {
                if(element.classList.contains(e.value)){
                    element.style.display = "block";
                }else{
                    element.style.display = "none";
                }
            });
        }
        window.onload = function(){
            AddHeader('login');
            if(localStorage.getItem('UserType')){
                window.location.href = "./index.html";
            }
            //hide all inputs
            let elements = document.getElementsByClassName("hiddeninput");
            Array.from(elements).forEach(function (element) {
                element.style.display = "none";
            });
            //get all talentmanagers and put them in select tag as options
            let element = document.getElementById("Talentmanager");
            fetch(URL + 'Talentmanager')
                .then(response => response.json())
                .then(data => {
                    // Create option elements and add them to the select element
                    data.forEach(item => {
                        const option = document.createElement("option");
                        option.text = item.name;
                        option.value = item.id;
                        element.add(option);
                    });
                })
                .catch(error => console.error(error));
            //get all specialization values and put them in a select tag as options
            let SpecializationSelectElement = document.getElementById("Specialization");
            fetch(URL + 'Specialization')
                .then(response => response.json())
                .then(data => {
                    // Create option elements and add them to the select element
                    for (var key in data) {
                        const option = document.createElement("option");
                        option.text = data[key];
                        option.value = key;
                        SpecializationSelectElement.add(option);
                    }
                })
                .catch(error => console.error(error));
        }
        
        //show value above radius input
        function showValue(value) {
            document.getElementById("rangevalue").innerHTML = value;
        }
	</script>
</body>
</html>